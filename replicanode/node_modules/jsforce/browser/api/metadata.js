import _Object$keys from "@babel/runtime-corejs3/core-js-stable/object/keys";
import _Object$getOwnPropertySymbols from "@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols";
import _filterInstanceProperty from "@babel/runtime-corejs3/core-js-stable/instance/filter";
import _Object$getOwnPropertyDescriptor from "@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor";
import _forEachInstanceProperty from "@babel/runtime-corejs3/core-js-stable/instance/for-each";
import _Object$getOwnPropertyDescriptors from "@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors";
import _Object$defineProperties from "@babel/runtime-corejs3/core-js-stable/object/define-properties";
import _Object$defineProperty from "@babel/runtime-corejs3/core-js-stable/object/define-property";
import _Reflect$construct from "@babel/runtime-corejs3/core-js-stable/reflect/construct";
import _readOnlyError from "@babel/runtime-corejs3/helpers/readOnlyError";
import _possibleConstructorReturn from "@babel/runtime-corejs3/helpers/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime-corejs3/helpers/getPrototypeOf";
import _inherits from "@babel/runtime-corejs3/helpers/inherits";
import _asyncToGenerator from "@babel/runtime-corejs3/helpers/asyncToGenerator";
import _classCallCheck from "@babel/runtime-corejs3/helpers/classCallCheck";
import _createClass from "@babel/runtime-corejs3/helpers/createClass";
import _defineProperty from "@babel/runtime-corejs3/helpers/defineProperty";
import _objectWithoutProperties from "@babel/runtime-corejs3/helpers/objectWithoutProperties";
var _excluded = ["$"];
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? _Reflect$construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
import "core-js/modules/es.error.cause.js";
import "core-js/modules/es.array.push.js";
import "core-js/modules/es.object.to-string.js";
import "core-js/modules/es.regexp.to-string.js";
import _regeneratorRuntime from "@babel/runtime-corejs3/regenerator";
import _Array$isArray from "@babel/runtime-corejs3/core-js-stable/array/is-array";
import _mapInstanceProperty from "@babel/runtime-corejs3/core-js-stable/instance/map";
import _concatInstanceProperty from "@babel/runtime-corejs3/core-js-stable/instance/concat";
import _JSON$stringify from "@babel/runtime-corejs3/core-js-stable/json/stringify";
import _Promise from "@babel/runtime-corejs3/core-js-stable/promise";
import _setTimeout from "@babel/runtime-corejs3/core-js-stable/set-timeout";
function ownKeys(e, r) { var t = _Object$keys(e); if (_Object$getOwnPropertySymbols) { var o = _Object$getOwnPropertySymbols(e); r && (o = _filterInstanceProperty(o).call(o, function (r) { return _Object$getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var _context17, _context18; var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? _forEachInstanceProperty(_context17 = ownKeys(Object(t), !0)).call(_context17, function (r) { _defineProperty(e, r, t[r]); }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(e, _Object$getOwnPropertyDescriptors(t)) : _forEachInstanceProperty(_context18 = ownKeys(Object(t))).call(_context18, function (r) { _Object$defineProperty(e, r, _Object$getOwnPropertyDescriptor(t, r)); }); } return e; }
/**
 * @file Manages Salesforce Metadata API
 * @author Shinichi Tomita <shinichi.tomita@gmail.com>
 */
import { EventEmitter } from 'events';
import { Readable } from 'stream';
import FormData from 'form-data';
import { registerModule } from '../jsforce';
import SOAP from '../soap';
import { isObject } from '../util/function';
import { ApiSchemas } from './metadata/schema';
export * from './metadata/schema';

/**
 *
 */

/**
 *
 */
function deallocateTypeWithMetadata(metadata) {
  var _ref = metadata,
    $ = _ref.$,
    md = _objectWithoutProperties(_ref, _excluded);
  return md;
}
function assignTypeWithMetadata(metadata, type) {
  var convert = function convert(md) {
    return _objectSpread(_defineProperty({}, '@xsi:type', type), md);
  };
  return _Array$isArray(metadata) ? _mapInstanceProperty(metadata).call(metadata, convert) : convert(metadata);
}

/**
 * Class for Salesforce Metadata API
 */
export var MetadataApi = /*#__PURE__*/function () {
  /**
   *
   */
  function MetadataApi(conn) {
    _classCallCheck(this, MetadataApi);
    /**
     * Polling interval in milliseconds
     */
    _defineProperty(this, "pollInterval", 1000);
    /**
     * Polling timeout in milliseconds
     */
    _defineProperty(this, "pollTimeout", 10000);
    this._conn = conn;
  }

  /**
   * Call Metadata API SOAP endpoint
   *
   * @private
   */
  return _createClass(MetadataApi, [{
    key: "_invoke",
    value: (function () {
      var _invoke2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(method, message, schema) {
        var _context;
        var soapEndpoint, res;
        return _regeneratorRuntime.wrap(function _callee$(_context2) {
          while (1) switch (_context2.prev = _context2.next) {
            case 0:
              soapEndpoint = new SOAP(this._conn, {
                xmlns: 'http://soap.sforce.com/2006/04/metadata',
                endpointUrl: _concatInstanceProperty(_context = "".concat(this._conn.instanceUrl, "/services/Soap/m/")).call(_context, this._conn.version)
              });
              _context2.next = 3;
              return soapEndpoint.invoke(method, message, schema ? {
                result: schema
              } : undefined, ApiSchemas);
            case 3:
              res = _context2.sent;
              return _context2.abrupt("return", res.result);
            case 5:
            case "end":
              return _context2.stop();
          }
        }, _callee, this);
      }));
      function _invoke(_x, _x2, _x3) {
        return _invoke2.apply(this, arguments);
      }
      return _invoke;
    }()
    /**
     * Add one or more new metadata components to the organization.
     */
    )
  }, {
    key: "create",
    value: function create(type, metadata) {
      var isArray = _Array$isArray(metadata);
      metadata = assignTypeWithMetadata(metadata, type);
      var schema = isArray ? [ApiSchemas.SaveResult] : ApiSchemas.SaveResult;
      return this._invoke('createMetadata', {
        metadata: metadata
      }, schema);
    }

    /**
     * Read specified metadata components in the organization.
     */
  }, {
    key: "read",
    value: function () {
      var _read = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(type, fullNames) {
        var _context3;
        var ReadResultSchema, res;
        return _regeneratorRuntime.wrap(function _callee2$(_context4) {
          while (1) switch (_context4.prev = _context4.next) {
            case 0:
              ReadResultSchema = type in ApiSchemas ? {
                type: ApiSchemas.ReadResult.type,
                props: {
                  records: [type]
                }
              } : ApiSchemas.ReadResult;
              _context4.next = 3;
              return this._invoke('readMetadata', {
                type: type,
                fullNames: fullNames
              }, ReadResultSchema);
            case 3:
              res = _context4.sent;
              return _context4.abrupt("return", _Array$isArray(fullNames) ? _mapInstanceProperty(_context3 = res.records).call(_context3, deallocateTypeWithMetadata) : deallocateTypeWithMetadata(res.records[0]));
            case 5:
            case "end":
              return _context4.stop();
          }
        }, _callee2, this);
      }));
      function read(_x4, _x5) {
        return _read.apply(this, arguments);
      }
      return read;
    }()
    /**
     * Update one or more metadata components in the organization.
     */
  }, {
    key: "update",
    value: function update(type, metadata) {
      var isArray = _Array$isArray(metadata);
      metadata = assignTypeWithMetadata(metadata, type);
      var schema = isArray ? [ApiSchemas.SaveResult] : ApiSchemas.SaveResult;
      return this._invoke('updateMetadata', {
        metadata: metadata
      }, schema);
    }

    /**
     * Upsert one or more components in your organization's data.
     */
  }, {
    key: "upsert",
    value: function upsert(type, metadata) {
      var isArray = _Array$isArray(metadata);
      metadata = assignTypeWithMetadata(metadata, type);
      var schema = isArray ? [ApiSchemas.UpsertResult] : ApiSchemas.UpsertResult;
      return this._invoke('upsertMetadata', {
        metadata: metadata
      }, schema);
    }

    /**
     * Deletes specified metadata components in the organization.
     */
  }, {
    key: "delete",
    value: function _delete(type, fullNames) {
      var schema = _Array$isArray(fullNames) ? [ApiSchemas.SaveResult] : ApiSchemas.SaveResult;
      return this._invoke('deleteMetadata', {
        type: type,
        fullNames: fullNames
      }, schema);
    }

    /**
     * Rename fullname of a metadata component in the organization
     */
  }, {
    key: "rename",
    value: function rename(type, oldFullName, newFullName) {
      return this._invoke('renameMetadata', {
        type: type,
        oldFullName: oldFullName,
        newFullName: newFullName
      }, ApiSchemas.SaveResult);
    }

    /**
     * Retrieves the metadata which describes your organization, including Apex classes and triggers,
     * custom objects, custom fields on standard objects, tab sets that define an app,
     * and many other components.
     */
  }, {
    key: "describe",
    value: function describe(asOfVersion) {
      if (!asOfVersion) {
        asOfVersion = this._conn.version;
      }
      return this._invoke('describeMetadata', {
        asOfVersion: asOfVersion
      }, ApiSchemas.DescribeMetadataResult);
    }

    /**
     * Retrieves property information about metadata components in your organization
     */
  }, {
    key: "list",
    value: function list(queries, asOfVersion) {
      if (!asOfVersion) {
        asOfVersion = this._conn.version;
      }
      return this._invoke('listMetadata', {
        queries: queries,
        asOfVersion: asOfVersion
      }, [ApiSchemas.FileProperties]);
    }

    /**
     * Checks the status of asynchronous metadata calls
     */
  }, {
    key: "checkStatus",
    value: function checkStatus(asyncProcessId) {
      var res = this._invoke('checkStatus', {
        asyncProcessId: asyncProcessId
      }, ApiSchemas.AsyncResult);
      return new AsyncResultLocator(this, res);
    }

    /**
     * Retrieves XML file representations of components in an organization
     */
  }, {
    key: "retrieve",
    value: function retrieve(request) {
      var res = this._invoke('retrieve', {
        request: request
      }, ApiSchemas.RetrieveResult);
      return new RetrieveResultLocator(this, res);
    }

    /**
     * Checks the status of declarative metadata call retrieve() and returns the zip file contents
     */
  }, {
    key: "checkRetrieveStatus",
    value: function checkRetrieveStatus(asyncProcessId) {
      return this._invoke('checkRetrieveStatus', {
        asyncProcessId: asyncProcessId
      }, ApiSchemas.RetrieveResult);
    }

    /**
     * Will deploy a recently validated deploy request
     *
     * @param options.id = the deploy ID that's been validated already from a previous checkOnly deploy request
     * @param options.rest = a boolean whether or not to use the REST API
     * @returns the deploy ID of the recent validation request
     */
  }, {
    key: "deployRecentValidation",
    value: (function () {
      var _deployRecentValidation = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(options) {
        var id, rest, response, messageBody, requestInfo, requestOptions;
        return _regeneratorRuntime.wrap(function _callee3$(_context5) {
          while (1) switch (_context5.prev = _context5.next) {
            case 0:
              id = options.id, rest = options.rest;
              if (!rest) {
                _context5.next = 10;
                break;
              }
              messageBody = _JSON$stringify({
                validatedDeployRequestId: id
              });
              requestInfo = {
                method: 'POST',
                url: "".concat(this._conn._baseUrl(), "/metadata/deployRequest"),
                body: messageBody,
                headers: {
                  'content-type': 'application/json'
                }
              };
              requestOptions = {
                headers: 'json'
              }; // This is the deploy ID of the deployRecentValidation response, not
              // the already validated deploy ID (i.e., validateddeployrequestid).
              // REST returns an object with an id property, SOAP returns the id as a string directly.
              _context5.next = 7;
              return this._conn.request(requestInfo, requestOptions);
            case 7:
              response = _context5.sent.id;
              _context5.next = 13;
              break;
            case 10:
              _context5.next = 12;
              return this._invoke('deployRecentValidation', {
                validationId: id
              });
            case 12:
              response = _context5.sent;
            case 13:
              return _context5.abrupt("return", response);
            case 14:
            case "end":
              return _context5.stop();
          }
        }, _callee3, this);
      }));
      function deployRecentValidation(_x6) {
        return _deployRecentValidation.apply(this, arguments);
      }
      return deployRecentValidation;
    }()
    /**
     * Deploy components into an organization using zipped file representations
     * using the REST Metadata API instead of SOAP
     */
    )
  }, {
    key: "deployRest",
    value: function deployRest(zipInput) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var form = new FormData();
      form.append('file', zipInput, {
        contentType: 'application/zip',
        filename: 'package.xml'
      });

      // Add the deploy options
      form.append('entity_content', _JSON$stringify({
        deployOptions: options
      }), {
        contentType: 'application/json'
      });
      var request = {
        url: '/metadata/deployRequest',
        method: 'POST',
        headers: _objectSpread({}, form.getHeaders()),
        body: form.getBuffer()
      };
      var res = this._conn.request(request);
      return new DeployResultLocator(this, res);
    }

    /**
     * Deploy components into an organization using zipped file representations
     */
  }, {
    key: "deploy",
    value: function deploy(zipInput) {
      var _this = this;
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var res = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {
        var zipContentB64;
        return _regeneratorRuntime.wrap(function _callee4$(_context6) {
          while (1) switch (_context6.prev = _context6.next) {
            case 0:
              _context6.next = 2;
              return new _Promise(function (resolve, reject) {
                if (isObject(zipInput) && 'pipe' in zipInput && typeof zipInput.pipe === 'function') {
                  var bufs = [];
                  zipInput.on('data', function (d) {
                    return bufs.push(d);
                  });
                  zipInput.on('error', reject);
                  zipInput.on('end', function () {
                    resolve(_concatInstanceProperty(Buffer).call(Buffer, bufs).toString('base64'));
                  });
                  // zipInput.resume();
                } else if (zipInput instanceof Buffer) {
                  resolve(zipInput.toString('base64'));
                } else if (zipInput instanceof String || typeof zipInput === 'string') {
                  resolve(zipInput);
                } else {
                  throw 'Unexpected zipInput type';
                }
              });
            case 2:
              zipContentB64 = _context6.sent;
              return _context6.abrupt("return", _this._invoke('deploy', {
                ZipFile: zipContentB64,
                DeployOptions: options
              }, ApiSchemas.DeployResult));
            case 4:
            case "end":
              return _context6.stop();
          }
        }, _callee4);
      }))();
      return new DeployResultLocator(this, res);
    }

    /**
     * Checks the status of declarative metadata call deploy(), using either
     * SOAP or REST APIs. SOAP is the default.
     */
  }, {
    key: "checkDeployStatus",
    value: (function () {
      var _checkDeployStatus = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(asyncProcessId) {
        var includeDetails,
          rest,
          _context7,
          url,
          _args5 = arguments;
        return _regeneratorRuntime.wrap(function _callee5$(_context8) {
          while (1) switch (_context8.prev = _context8.next) {
            case 0:
              includeDetails = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : false;
              rest = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : false;
              if (!rest) {
                _context8.next = 9;
                break;
              }
              url = _concatInstanceProperty(_context7 = "/metadata/deployRequest/".concat(asyncProcessId)).call(_context7, includeDetails ? '?includeDetails=true' : '');
              _context8.next = 6;
              return this._conn.requestGet(url);
            case 6:
              return _context8.abrupt("return", _context8.sent.deployResult);
            case 9:
              return _context8.abrupt("return", this._invoke('checkDeployStatus', {
                asyncProcessId: asyncProcessId,
                includeDetails: includeDetails
              }, ApiSchemas.DeployResult));
            case 10:
            case "end":
              return _context8.stop();
          }
        }, _callee5, this);
      }));
      function checkDeployStatus(_x7) {
        return _checkDeployStatus.apply(this, arguments);
      }
      return checkDeployStatus;
    }())
  }, {
    key: "cancelDeploy",
    value: function () {
      var _cancelDeploy = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id) {
        return _regeneratorRuntime.wrap(function _callee6$(_context9) {
          while (1) switch (_context9.prev = _context9.next) {
            case 0:
              return _context9.abrupt("return", this._invoke('cancelDeploy', {
                id: id
              }));
            case 1:
            case "end":
              return _context9.stop();
          }
        }, _callee6, this);
      }));
      function cancelDeploy(_x8) {
        return _cancelDeploy.apply(this, arguments);
      }
      return cancelDeploy;
    }()
  }]);
}();

/*--------------------------------------------*/

/**
 * The locator class for Metadata API asynchronous call result
 */
export var AsyncResultLocator = /*#__PURE__*/function (_EventEmitter) {
  /**
   *
   */
  function AsyncResultLocator(meta, promise) {
    var _this2;
    _classCallCheck(this, AsyncResultLocator);
    _this2 = _callSuper(this, AsyncResultLocator);
    _this2._meta = meta;
    _this2._promise = promise;
    return _this2;
  }

  /**
   * Promise/A+ interface
   * http://promises-aplus.github.io/promises-spec/
   *
   * @method Metadata~AsyncResultLocator#then
   */
  _inherits(AsyncResultLocator, _EventEmitter);
  return _createClass(AsyncResultLocator, [{
    key: "then",
    value: function then(onResolve, onReject) {
      return this._promise.then(onResolve, onReject);
    }

    /**
     * Check the status of async request
     */
  }, {
    key: "check",
    value: (function () {
      var _check = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {
        var result;
        return _regeneratorRuntime.wrap(function _callee7$(_context10) {
          while (1) switch (_context10.prev = _context10.next) {
            case 0:
              _context10.next = 2;
              return this._promise;
            case 2:
              result = _context10.sent;
              this._id = result.id;
              return _context10.abrupt("return", this._meta.checkStatus(result.id));
            case 5:
            case "end":
              return _context10.stop();
          }
        }, _callee7, this);
      }));
      function check() {
        return _check.apply(this, arguments);
      }
      return check;
    }()
    /**
     * Polling until async call status becomes complete or error
     */
    )
  }, {
    key: "poll",
    value: function _poll(interval, timeout) {
      var _this3 = this;
      var startTime = new Date().getTime();
      var _poll = /*#__PURE__*/function () {
        var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {
          var now, errMsg, result;
          return _regeneratorRuntime.wrap(function _callee8$(_context11) {
            while (1) switch (_context11.prev = _context11.next) {
              case 0:
                _context11.prev = 0;
                now = new Date().getTime();
                if (!(startTime + timeout < now)) {
                  _context11.next = 7;
                  break;
                }
                errMsg = 'Polling time out.';
                if (_this3._id) {
                  errMsg += ' Process Id = ' + _this3._id;
                }
                _this3.emit('error', new Error(errMsg));
                return _context11.abrupt("return");
              case 7:
                _context11.next = 9;
                return _this3.check();
              case 9:
                result = _context11.sent;
                if (result.done) {
                  _this3.emit('complete', result);
                } else {
                  _this3.emit('progress', result);
                  _setTimeout(_poll, interval);
                }
                _context11.next = 16;
                break;
              case 13:
                _context11.prev = 13;
                _context11.t0 = _context11["catch"](0);
                _this3.emit('error', _context11.t0);
              case 16:
              case "end":
                return _context11.stop();
            }
          }, _callee8, null, [[0, 13]]);
        }));
        return function poll() {
          return _ref3.apply(this, arguments);
        };
      }();
      _setTimeout(_poll, interval);
    }

    /**
     * Check and wait until the async requests become in completed status
     */
  }, {
    key: "complete",
    value: function complete() {
      var _this4 = this;
      return new _Promise(function (resolve, reject) {
        _this4.on('complete', resolve);
        _this4.on('error', reject);
        _this4.poll(_this4._meta.pollInterval, _this4._meta.pollTimeout);
      });
    }
  }]);
}(EventEmitter);

/*--------------------------------------------*/
/**
 * The locator class to track retreive() Metadata API call result
 */
export var RetrieveResultLocator = /*#__PURE__*/function (_AsyncResultLocator) {
  function RetrieveResultLocator() {
    _classCallCheck(this, RetrieveResultLocator);
    return _callSuper(this, RetrieveResultLocator, arguments);
  }
  _inherits(RetrieveResultLocator, _AsyncResultLocator);
  return _createClass(RetrieveResultLocator, [{
    key: "complete",
    value: (
    /**
     * Poll checkRetrieveStatus() until the retrieve operation completes,
     * then return the RetrieveResult.
     */
    function () {
      var _complete = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {
        var _this5 = this;
        var asyncResult, id;
        return _regeneratorRuntime.wrap(function _callee10$(_context13) {
          while (1) switch (_context13.prev = _context13.next) {
            case 0:
              if (this._id) {
                _context13.next = 5;
                break;
              }
              _context13.next = 3;
              return this._promise;
            case 3:
              asyncResult = _context13.sent;
              this._id = asyncResult.id;
            case 5:
              id = this._id;
              return _context13.abrupt("return", new _Promise(function (resolve, reject) {
                var startTime = new Date().getTime();
                var _poll2 = /*#__PURE__*/function () {
                  var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {
                    var now, err, result;
                    return _regeneratorRuntime.wrap(function _callee9$(_context12) {
                      while (1) switch (_context12.prev = _context12.next) {
                        case 0:
                          _context12.prev = 0;
                          now = new Date().getTime();
                          if (!(startTime + _this5._meta.pollTimeout < now)) {
                            _context12.next = 7;
                            break;
                          }
                          err = new Error('Polling time out. Retrieve operation is not completed.');
                          _this5.emit('error', err);
                          reject(err);
                          return _context12.abrupt("return");
                        case 7:
                          _context12.next = 9;
                          return _this5._meta.checkRetrieveStatus(id);
                        case 9:
                          result = _context12.sent;
                          if (result.done) {
                            _this5.emit('complete', result);
                            resolve(result);
                          } else {
                            _this5.emit('progress', result);
                            _setTimeout(_poll2, _this5._meta.pollInterval);
                          }
                          _context12.next = 17;
                          break;
                        case 13:
                          _context12.prev = 13;
                          _context12.t0 = _context12["catch"](0);
                          _this5.emit('error', _context12.t0);
                          reject(_context12.t0);
                        case 17:
                        case "end":
                          return _context12.stop();
                      }
                    }, _callee9, null, [[0, 13]]);
                  }));
                  return function poll() {
                    return _ref4.apply(this, arguments);
                  };
                }();
                _setTimeout(_poll2, _this5._meta.pollInterval);
              }));
            case 7:
            case "end":
              return _context13.stop();
          }
        }, _callee10, this);
      }));
      function complete() {
        return _complete.apply(this, arguments);
      }
      return complete;
    }()
    /**
     * Change the retrieved result to Node.js readable stream
     */
    )
  }, {
    key: "stream",
    value: function stream() {
      var _this6 = this;
      var resultStream = new Readable();
      var reading = false;
      resultStream._read = /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {
        var result;
        return _regeneratorRuntime.wrap(function _callee11$(_context14) {
          while (1) switch (_context14.prev = _context14.next) {
            case 0:
              if (!reading) {
                _context14.next = 2;
                break;
              }
              return _context14.abrupt("return");
            case 2:
              reading = true;
              _context14.prev = 3;
              _context14.next = 6;
              return _this6.complete();
            case 6:
              result = _context14.sent;
              resultStream.push(Buffer.from(result.zipFile, 'base64'));
              resultStream.push(null);
              _context14.next = 14;
              break;
            case 11:
              _context14.prev = 11;
              _context14.t0 = _context14["catch"](3);
              resultStream.emit('error', _context14.t0);
            case 14:
            case "end":
              return _context14.stop();
          }
        }, _callee11, null, [[3, 11]]);
      }));
      return resultStream;
    }
  }]);
}(AsyncResultLocator);

/*--------------------------------------------*/
/**
 * The locator class to track deploy() Metadata API call result
 *
 * @protected
 * @class Metadata~DeployResultLocator
 * @extends Metadata~AsyncResultLocator
 * @param {Metadata} meta - Metadata API object
 * @param {Promise.<Metadata~AsyncResult>} result - Promise object for async result of deploy() call
 */
export var DeployResultLocator = /*#__PURE__*/function (_AsyncResultLocator2) {
  function DeployResultLocator() {
    _classCallCheck(this, DeployResultLocator);
    return _callSuper(this, DeployResultLocator, arguments);
  }
  _inherits(DeployResultLocator, _AsyncResultLocator2);
  return _createClass(DeployResultLocator, [{
    key: "complete",
    value: (
    /**
     * Poll checkDeployStatus() until the deploy operation completes,
     * then return the DeployResult.
     */
    function () {
      var _complete2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(includeDetails) {
        var _this7 = this;
        var asyncResult, id;
        return _regeneratorRuntime.wrap(function _callee13$(_context16) {
          while (1) switch (_context16.prev = _context16.next) {
            case 0:
              if (this._id) {
                _context16.next = 5;
                break;
              }
              _context16.next = 3;
              return this._promise;
            case 3:
              asyncResult = _context16.sent;
              this._id = asyncResult.id;
            case 5:
              id = this._id;
              return _context16.abrupt("return", new _Promise(function (resolve, reject) {
                var startTime = new Date().getTime();
                var _poll3 = /*#__PURE__*/function () {
                  var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {
                    var now, err, result;
                    return _regeneratorRuntime.wrap(function _callee12$(_context15) {
                      while (1) switch (_context15.prev = _context15.next) {
                        case 0:
                          _context15.prev = 0;
                          now = new Date().getTime();
                          if (!(startTime + _this7._meta.pollTimeout < now)) {
                            _context15.next = 7;
                            break;
                          }
                          err = new Error('Polling time out. Deploy operation is not completed.');
                          _this7.emit('error', err);
                          reject(err);
                          return _context15.abrupt("return");
                        case 7:
                          _context15.next = 9;
                          return _this7._meta.checkDeployStatus(id, includeDetails);
                        case 9:
                          result = _context15.sent;
                          if (result.done) {
                            _this7.emit('complete', result);
                            resolve(result);
                          } else {
                            _this7.emit('progress', result);
                            _setTimeout(_poll3, _this7._meta.pollInterval);
                          }
                          _context15.next = 17;
                          break;
                        case 13:
                          _context15.prev = 13;
                          _context15.t0 = _context15["catch"](0);
                          _this7.emit('error', _context15.t0);
                          reject(_context15.t0);
                        case 17:
                        case "end":
                          return _context15.stop();
                      }
                    }, _callee12, null, [[0, 13]]);
                  }));
                  return function poll() {
                    return _ref6.apply(this, arguments);
                  };
                }();
                _setTimeout(_poll3, _this7._meta.pollInterval);
              }));
            case 7:
            case "end":
              return _context16.stop();
          }
        }, _callee13, this);
      }));
      function complete(_x9) {
        return _complete2.apply(this, arguments);
      }
      return complete;
    }())
  }]);
}(AsyncResultLocator);

/*--------------------------------------------*/
/*
 * Register hook in connection instantiation for dynamically adding this API module features
 */
registerModule('metadata', function (conn) {
  return new MetadataApi(conn);
});
export default MetadataApi;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFdmVudEVtaXR0ZXIiLCJSZWFkYWJsZSIsIkZvcm1EYXRhIiwicmVnaXN0ZXJNb2R1bGUiLCJTT0FQIiwiaXNPYmplY3QiLCJBcGlTY2hlbWFzIiwiZGVhbGxvY2F0ZVR5cGVXaXRoTWV0YWRhdGEiLCJtZXRhZGF0YSIsIl9yZWYiLCIkIiwibWQiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMiLCJfZXhjbHVkZWQiLCJhc3NpZ25UeXBlV2l0aE1ldGFkYXRhIiwidHlwZSIsImNvbnZlcnQiLCJfb2JqZWN0U3ByZWFkIiwiX2RlZmluZVByb3BlcnR5IiwiX0FycmF5JGlzQXJyYXkiLCJfbWFwSW5zdGFuY2VQcm9wZXJ0eSIsImNhbGwiLCJNZXRhZGF0YUFwaSIsImNvbm4iLCJfY2xhc3NDYWxsQ2hlY2siLCJfY29ubiIsIl9jcmVhdGVDbGFzcyIsImtleSIsInZhbHVlIiwiX2ludm9rZTIiLCJfYXN5bmNUb0dlbmVyYXRvciIsIl9yZWdlbmVyYXRvclJ1bnRpbWUiLCJtYXJrIiwiX2NhbGxlZSIsIm1ldGhvZCIsIm1lc3NhZ2UiLCJzY2hlbWEiLCJfY29udGV4dCIsInNvYXBFbmRwb2ludCIsInJlcyIsIndyYXAiLCJfY2FsbGVlJCIsIl9jb250ZXh0MiIsInByZXYiLCJuZXh0IiwieG1sbnMiLCJlbmRwb2ludFVybCIsIl9jb25jYXRJbnN0YW5jZVByb3BlcnR5IiwiY29uY2F0IiwiaW5zdGFuY2VVcmwiLCJ2ZXJzaW9uIiwiaW52b2tlIiwicmVzdWx0IiwidW5kZWZpbmVkIiwic2VudCIsImFicnVwdCIsInN0b3AiLCJfaW52b2tlIiwiX3giLCJfeDIiLCJfeDMiLCJhcHBseSIsImFyZ3VtZW50cyIsImNyZWF0ZSIsImlzQXJyYXkiLCJTYXZlUmVzdWx0IiwiX3JlYWQiLCJfY2FsbGVlMiIsImZ1bGxOYW1lcyIsIl9jb250ZXh0MyIsIlJlYWRSZXN1bHRTY2hlbWEiLCJfY2FsbGVlMiQiLCJfY29udGV4dDQiLCJSZWFkUmVzdWx0IiwicHJvcHMiLCJyZWNvcmRzIiwicmVhZCIsIl94NCIsIl94NSIsInVwZGF0ZSIsInVwc2VydCIsIlVwc2VydFJlc3VsdCIsImRlbGV0ZSIsInJlbmFtZSIsIm9sZEZ1bGxOYW1lIiwibmV3RnVsbE5hbWUiLCJkZXNjcmliZSIsImFzT2ZWZXJzaW9uIiwiRGVzY3JpYmVNZXRhZGF0YVJlc3VsdCIsImxpc3QiLCJxdWVyaWVzIiwiRmlsZVByb3BlcnRpZXMiLCJjaGVja1N0YXR1cyIsImFzeW5jUHJvY2Vzc0lkIiwiQXN5bmNSZXN1bHQiLCJBc3luY1Jlc3VsdExvY2F0b3IiLCJyZXRyaWV2ZSIsInJlcXVlc3QiLCJSZXRyaWV2ZVJlc3VsdCIsIlJldHJpZXZlUmVzdWx0TG9jYXRvciIsImNoZWNrUmV0cmlldmVTdGF0dXMiLCJfZGVwbG95UmVjZW50VmFsaWRhdGlvbiIsIl9jYWxsZWUzIiwib3B0aW9ucyIsImlkIiwicmVzdCIsInJlc3BvbnNlIiwibWVzc2FnZUJvZHkiLCJyZXF1ZXN0SW5mbyIsInJlcXVlc3RPcHRpb25zIiwiX2NhbGxlZTMkIiwiX2NvbnRleHQ1IiwiX0pTT04kc3RyaW5naWZ5IiwidmFsaWRhdGVkRGVwbG95UmVxdWVzdElkIiwidXJsIiwiX2Jhc2VVcmwiLCJib2R5IiwiaGVhZGVycyIsInZhbGlkYXRpb25JZCIsImRlcGxveVJlY2VudFZhbGlkYXRpb24iLCJfeDYiLCJkZXBsb3lSZXN0IiwiemlwSW5wdXQiLCJsZW5ndGgiLCJmb3JtIiwiYXBwZW5kIiwiY29udGVudFR5cGUiLCJmaWxlbmFtZSIsImRlcGxveU9wdGlvbnMiLCJnZXRIZWFkZXJzIiwiZ2V0QnVmZmVyIiwiRGVwbG95UmVzdWx0TG9jYXRvciIsImRlcGxveSIsIl90aGlzIiwiX2NhbGxlZTQiLCJ6aXBDb250ZW50QjY0IiwiX2NhbGxlZTQkIiwiX2NvbnRleHQ2IiwiX1Byb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicGlwZSIsImJ1ZnMiLCJvbiIsImQiLCJwdXNoIiwiQnVmZmVyIiwidG9TdHJpbmciLCJTdHJpbmciLCJaaXBGaWxlIiwiRGVwbG95T3B0aW9ucyIsIkRlcGxveVJlc3VsdCIsIl9jaGVja0RlcGxveVN0YXR1cyIsIl9jYWxsZWU1IiwiaW5jbHVkZURldGFpbHMiLCJfY29udGV4dDciLCJfYXJnczUiLCJfY2FsbGVlNSQiLCJfY29udGV4dDgiLCJyZXF1ZXN0R2V0IiwiZGVwbG95UmVzdWx0IiwiY2hlY2tEZXBsb3lTdGF0dXMiLCJfeDciLCJfY2FuY2VsRGVwbG95IiwiX2NhbGxlZTYiLCJfY2FsbGVlNiQiLCJfY29udGV4dDkiLCJjYW5jZWxEZXBsb3kiLCJfeDgiLCJfRXZlbnRFbWl0dGVyIiwibWV0YSIsInByb21pc2UiLCJfdGhpczIiLCJfY2FsbFN1cGVyIiwiX21ldGEiLCJfcHJvbWlzZSIsIl9pbmhlcml0cyIsInRoZW4iLCJvblJlc29sdmUiLCJvblJlamVjdCIsIl9jaGVjayIsIl9jYWxsZWU3IiwiX2NhbGxlZTckIiwiX2NvbnRleHQxMCIsIl9pZCIsImNoZWNrIiwicG9sbCIsImludGVydmFsIiwidGltZW91dCIsIl90aGlzMyIsInN0YXJ0VGltZSIsIkRhdGUiLCJnZXRUaW1lIiwiX3JlZjMiLCJfY2FsbGVlOCIsIm5vdyIsImVyck1zZyIsIl9jYWxsZWU4JCIsIl9jb250ZXh0MTEiLCJlbWl0IiwiRXJyb3IiLCJkb25lIiwiX3NldFRpbWVvdXQiLCJ0MCIsImNvbXBsZXRlIiwiX3RoaXM0IiwicG9sbEludGVydmFsIiwicG9sbFRpbWVvdXQiLCJfQXN5bmNSZXN1bHRMb2NhdG9yIiwiX2NvbXBsZXRlIiwiX2NhbGxlZTEwIiwiX3RoaXM1IiwiYXN5bmNSZXN1bHQiLCJfY2FsbGVlMTAkIiwiX2NvbnRleHQxMyIsIl9yZWY0IiwiX2NhbGxlZTkiLCJlcnIiLCJfY2FsbGVlOSQiLCJfY29udGV4dDEyIiwic3RyZWFtIiwiX3RoaXM2IiwicmVzdWx0U3RyZWFtIiwicmVhZGluZyIsIl9jYWxsZWUxMSIsIl9jYWxsZWUxMSQiLCJfY29udGV4dDE0IiwiZnJvbSIsInppcEZpbGUiLCJfQXN5bmNSZXN1bHRMb2NhdG9yMiIsIl9jb21wbGV0ZTIiLCJfY2FsbGVlMTMiLCJfdGhpczciLCJfY2FsbGVlMTMkIiwiX2NvbnRleHQxNiIsIl9yZWY2IiwiX2NhbGxlZTEyIiwiX2NhbGxlZTEyJCIsIl9jb250ZXh0MTUiLCJfeDkiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvYXBpL21ldGFkYXRhLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGUgTWFuYWdlcyBTYWxlc2ZvcmNlIE1ldGFkYXRhIEFQSVxuICogQGF1dGhvciBTaGluaWNoaSBUb21pdGEgPHNoaW5pY2hpLnRvbWl0YUBnbWFpbC5jb20+XG4gKi9cbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgRm9ybURhdGEgZnJvbSAnZm9ybS1kYXRhJztcbmltcG9ydCB7IHJlZ2lzdGVyTW9kdWxlIH0gZnJvbSAnLi4vanNmb3JjZSc7XG5pbXBvcnQgQ29ubmVjdGlvbiBmcm9tICcuLi9jb25uZWN0aW9uJztcbmltcG9ydCBTT0FQIGZyb20gJy4uL3NvYXAnO1xuaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tICcuLi91dGlsL2Z1bmN0aW9uJztcbmltcG9ydCB7IFNjaGVtYSwgU29hcFNjaGVtYURlZiwgU29hcFNjaGVtYSwgSHR0cFJlcXVlc3QgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQge1xuICBBcGlTY2hlbWFzLFxuICBNZXRhZGF0YSxcbiAgUmVhZFJlc3VsdCxcbiAgU2F2ZVJlc3VsdCxcbiAgVXBzZXJ0UmVzdWx0LFxuICBMaXN0TWV0YWRhdGFRdWVyeSxcbiAgRmlsZVByb3BlcnRpZXMsXG4gIERlc2NyaWJlTWV0YWRhdGFSZXN1bHQsXG4gIFJldHJpZXZlUmVxdWVzdCxcbiAgRGVwbG95T3B0aW9ucyxcbiAgUmV0cmlldmVSZXN1bHQsXG4gIERlcGxveVJlc3VsdCxcbiAgQXN5bmNSZXN1bHQsXG4gIEFwaVNjaGVtYVR5cGVzLCBDYW5jZWxEZXBsb3lSZXN1bHQsXG59IGZyb20gJy4vbWV0YWRhdGEvc2NoZW1hJztcbmV4cG9ydCAqIGZyb20gJy4vbWV0YWRhdGEvc2NoZW1hJztcblxuLyoqXG4gKlxuICovXG50eXBlIE1ldGFkYXRhVHlwZV88XG4gIEsgZXh0ZW5kcyBrZXlvZiBBcGlTY2hlbWFUeXBlcyA9IGtleW9mIEFwaVNjaGVtYVR5cGVzXG4+ID0gSyBleHRlbmRzIGtleW9mIEFwaVNjaGVtYVR5cGVzXG4gID8gQXBpU2NoZW1hVHlwZXNbS10gZXh0ZW5kcyBNZXRhZGF0YVxuICAgID8gS1xuICAgIDogbmV2ZXJcbiAgOiBuZXZlcjtcblxuZXhwb3J0IHR5cGUgTWV0YWRhdGFUeXBlID0gTWV0YWRhdGFUeXBlXztcblxuZXhwb3J0IHR5cGUgTWV0YWRhdGFEZWZpbml0aW9uPFxuICBUIGV4dGVuZHMgc3RyaW5nLFxuICBNIGV4dGVuZHMgTWV0YWRhdGEgPSBNZXRhZGF0YVxuPiA9IE1ldGFkYXRhIGV4dGVuZHMgTVxuICA/IFQgZXh0ZW5kcyBrZXlvZiBBcGlTY2hlbWFUeXBlcyAmIE1ldGFkYXRhVHlwZVxuICAgID8gQXBpU2NoZW1hVHlwZXNbVF0gZXh0ZW5kcyBNZXRhZGF0YVxuICAgICAgPyBBcGlTY2hlbWFUeXBlc1tUXVxuICAgICAgOiBNZXRhZGF0YVxuICAgIDogTWV0YWRhdGFcbiAgOiBNO1xuXG50eXBlIERlZXBQYXJ0aWFsPFQ+ID0gVCBleHRlbmRzIGFueVtdXG4gID8gQXJyYXk8RGVlcFBhcnRpYWw8VFtudW1iZXJdPj5cbiAgOiBUIGV4dGVuZHMgb2JqZWN0XG4gID8geyBbSyBpbiBrZXlvZiBUXT86IERlZXBQYXJ0aWFsPFRbS10+IH1cbiAgOiBUO1xuXG5leHBvcnQgdHlwZSBJbnB1dE1ldGFkYXRhRGVmaW5pdGlvbjxcbiAgVCBleHRlbmRzIHN0cmluZyxcbiAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGFcbj4gPSBEZWVwUGFydGlhbDxNZXRhZGF0YURlZmluaXRpb248VCwgTT4+O1xuXG4vKipcbiAqXG4gKi9cbmZ1bmN0aW9uIGRlYWxsb2NhdGVUeXBlV2l0aE1ldGFkYXRhPE0gZXh0ZW5kcyBNZXRhZGF0YT4obWV0YWRhdGE6IE0pOiBNIHtcbiAgY29uc3QgeyAkLCAuLi5tZCB9ID0gbWV0YWRhdGEgYXMgYW55O1xuICByZXR1cm4gbWQ7XG59XG5cbmZ1bmN0aW9uIGFzc2lnblR5cGVXaXRoTWV0YWRhdGEobWV0YWRhdGE6IE1ldGFkYXRhIHwgTWV0YWRhdGFbXSwgdHlwZTogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbnZlcnQgPSAobWQ6IE1ldGFkYXRhKSA9PiAoeyBbJ0B4c2k6dHlwZSddOiB0eXBlLCAuLi5tZCB9KTtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkobWV0YWRhdGEpID8gbWV0YWRhdGEubWFwKGNvbnZlcnQpIDogY29udmVydChtZXRhZGF0YSk7XG59XG5cbi8qKlxuICogQ2xhc3MgZm9yIFNhbGVzZm9yY2UgTWV0YWRhdGEgQVBJXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUFwaTxTIGV4dGVuZHMgU2NoZW1hPiB7XG4gIF9jb25uOiBDb25uZWN0aW9uPFM+O1xuXG4gIC8qKlxuICAgKiBQb2xsaW5nIGludGVydmFsIGluIG1pbGxpc2Vjb25kc1xuICAgKi9cbiAgcG9sbEludGVydmFsOiBudW1iZXIgPSAxMDAwO1xuXG4gIC8qKlxuICAgKiBQb2xsaW5nIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzXG4gICAqL1xuICBwb2xsVGltZW91dDogbnVtYmVyID0gMTAwMDA7XG5cbiAgLyoqXG4gICAqXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb25uOiBDb25uZWN0aW9uPFM+KSB7XG4gICAgdGhpcy5fY29ubiA9IGNvbm47XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBNZXRhZGF0YSBBUEkgU09BUCBlbmRwb2ludFxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYXN5bmMgX2ludm9rZShcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBtZXNzYWdlOiBvYmplY3QsXG4gICAgc2NoZW1hPzogU29hcFNjaGVtYSB8IFNvYXBTY2hlbWFEZWYsXG4gICkge1xuICAgIGNvbnN0IHNvYXBFbmRwb2ludCA9IG5ldyBTT0FQKHRoaXMuX2Nvbm4sIHtcbiAgICAgIHhtbG5zOiAnaHR0cDovL3NvYXAuc2ZvcmNlLmNvbS8yMDA2LzA0L21ldGFkYXRhJyxcbiAgICAgIGVuZHBvaW50VXJsOiBgJHt0aGlzLl9jb25uLmluc3RhbmNlVXJsfS9zZXJ2aWNlcy9Tb2FwL20vJHt0aGlzLl9jb25uLnZlcnNpb259YCxcbiAgICB9KTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBzb2FwRW5kcG9pbnQuaW52b2tlKFxuICAgICAgbWV0aG9kLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHNjaGVtYSA/ICh7IHJlc3VsdDogc2NoZW1hIH0gYXMgU29hcFNjaGVtYSkgOiB1bmRlZmluZWQsXG4gICAgICBBcGlTY2hlbWFzLFxuICAgICk7XG4gICAgcmV0dXJuIHJlcy5yZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQWRkIG9uZSBvciBtb3JlIG5ldyBtZXRhZGF0YSBjb21wb25lbnRzIHRvIHRoZSBvcmdhbml6YXRpb24uXG4gICAqL1xuICBjcmVhdGU8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIE1ldGFkYXRhVHlwZSA9IE1ldGFkYXRhVHlwZSxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPih0eXBlOiBULCBtZXRhZGF0YTogTURbXSk6IFByb21pc2U8U2F2ZVJlc3VsdFtdPjtcbiAgY3JlYXRlPFxuICAgIE0gZXh0ZW5kcyBNZXRhZGF0YSA9IE1ldGFkYXRhLFxuICAgIFQgZXh0ZW5kcyBNZXRhZGF0YVR5cGUgPSBNZXRhZGF0YVR5cGUsXG4gICAgTUQgZXh0ZW5kcyBJbnB1dE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPiA9IElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+XG4gID4odHlwZTogVCwgbWV0YWRhdGE6IE1EKTogUHJvbWlzZTxTYXZlUmVzdWx0PjtcbiAgY3JlYXRlPFxuICAgIE0gZXh0ZW5kcyBNZXRhZGF0YSA9IE1ldGFkYXRhLFxuICAgIFQgZXh0ZW5kcyBNZXRhZGF0YVR5cGUgPSBNZXRhZGF0YVR5cGUsXG4gICAgTUQgZXh0ZW5kcyBJbnB1dE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPiA9IElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+XG4gID4odHlwZTogVCwgbWV0YWRhdGE6IE1EIHwgTURbXSk6IFByb21pc2U8U2F2ZVJlc3VsdCB8IFNhdmVSZXN1bHRbXT47XG4gIGNyZWF0ZSh0eXBlOiBzdHJpbmcsIG1ldGFkYXRhOiBNZXRhZGF0YSB8IE1ldGFkYXRhW10pIHtcbiAgICBjb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheShtZXRhZGF0YSk7XG4gICAgbWV0YWRhdGEgPSBhc3NpZ25UeXBlV2l0aE1ldGFkYXRhKG1ldGFkYXRhLCB0eXBlKTtcbiAgICBjb25zdCBzY2hlbWEgPSBpc0FycmF5ID8gW0FwaVNjaGVtYXMuU2F2ZVJlc3VsdF0gOiBBcGlTY2hlbWFzLlNhdmVSZXN1bHQ7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZSgnY3JlYXRlTWV0YWRhdGEnLCB7IG1ldGFkYXRhIH0sIHNjaGVtYSk7XG4gIH1cblxuICAvKipcbiAgICogUmVhZCBzcGVjaWZpZWQgbWV0YWRhdGEgY29tcG9uZW50cyBpbiB0aGUgb3JnYW5pemF0aW9uLlxuICAgKi9cbiAgcmVhZDxcbiAgICBNIGV4dGVuZHMgTWV0YWRhdGEgPSBNZXRhZGF0YSxcbiAgICBUIGV4dGVuZHMgTWV0YWRhdGFUeXBlID0gTWV0YWRhdGFUeXBlLFxuICAgIE1EIGV4dGVuZHMgTWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gTWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+XG4gID4odHlwZTogVCwgZnVsbE5hbWVzOiBzdHJpbmdbXSk6IFByb21pc2U8TURbXT47XG4gIHJlYWQ8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIE1ldGFkYXRhVHlwZSA9IE1ldGFkYXRhVHlwZSxcbiAgICBNRCBleHRlbmRzIE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPiA9IE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPlxuICA+KHR5cGU6IFQsIGZ1bGxOYW1lczogc3RyaW5nKTogUHJvbWlzZTxNRD47XG4gIHJlYWQ8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIE1ldGFkYXRhVHlwZSA9IE1ldGFkYXRhVHlwZSxcbiAgICBNRCBleHRlbmRzIE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPiA9IE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPlxuICA+KHR5cGU6IFQsIGZ1bGxOYW1lczogc3RyaW5nIHwgc3RyaW5nW10pOiBQcm9taXNlPE1EIHwgTURbXT47XG4gIGFzeW5jIHJlYWQodHlwZTogc3RyaW5nLCBmdWxsTmFtZXM6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgUmVhZFJlc3VsdFNjaGVtYSA9XG4gICAgICB0eXBlIGluIEFwaVNjaGVtYXNcbiAgICAgICAgPyAoe1xuICAgICAgICAgICAgdHlwZTogQXBpU2NoZW1hcy5SZWFkUmVzdWx0LnR5cGUsXG4gICAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgICByZWNvcmRzOiBbdHlwZV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0gYXMgY29uc3QpXG4gICAgICAgIDogQXBpU2NoZW1hcy5SZWFkUmVzdWx0O1xuICAgIGNvbnN0IHJlczogUmVhZFJlc3VsdCA9IGF3YWl0IHRoaXMuX2ludm9rZShcbiAgICAgICdyZWFkTWV0YWRhdGEnLFxuICAgICAgeyB0eXBlLCBmdWxsTmFtZXMgfSxcbiAgICAgIFJlYWRSZXN1bHRTY2hlbWEsXG4gICAgKTtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShmdWxsTmFtZXMpXG4gICAgICA/IHJlcy5yZWNvcmRzLm1hcChkZWFsbG9jYXRlVHlwZVdpdGhNZXRhZGF0YSlcbiAgICAgIDogZGVhbGxvY2F0ZVR5cGVXaXRoTWV0YWRhdGEocmVzLnJlY29yZHNbMF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBvbmUgb3IgbW9yZSBtZXRhZGF0YSBjb21wb25lbnRzIGluIHRoZSBvcmdhbml6YXRpb24uXG4gICAqL1xuICB1cGRhdGU8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIHN0cmluZyA9IHN0cmluZyxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPih0eXBlOiBULCBtZXRhZGF0YTogQXJyYXk8UGFydGlhbDxNRD4+KTogUHJvbWlzZTxTYXZlUmVzdWx0W10+O1xuICB1cGRhdGU8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIHN0cmluZyA9IHN0cmluZyxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPih0eXBlOiBULCBtZXRhZGF0YTogUGFydGlhbDxNRD4pOiBQcm9taXNlPFNhdmVSZXN1bHQ+O1xuICB1cGRhdGU8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIHN0cmluZyA9IHN0cmluZyxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPihcbiAgICB0eXBlOiBULFxuICAgIG1ldGFkYXRhOiBQYXJ0aWFsPE1EPiB8IEFycmF5PFBhcnRpYWw8TUQ+PixcbiAgKTogUHJvbWlzZTxTYXZlUmVzdWx0IHwgU2F2ZVJlc3VsdFtdPjtcbiAgdXBkYXRlKHR5cGU6IHN0cmluZywgbWV0YWRhdGE6IE1ldGFkYXRhIHwgTWV0YWRhdGFbXSkge1xuICAgIGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5KG1ldGFkYXRhKTtcbiAgICBtZXRhZGF0YSA9IGFzc2lnblR5cGVXaXRoTWV0YWRhdGEobWV0YWRhdGEsIHR5cGUpO1xuICAgIGNvbnN0IHNjaGVtYSA9IGlzQXJyYXkgPyBbQXBpU2NoZW1hcy5TYXZlUmVzdWx0XSA6IEFwaVNjaGVtYXMuU2F2ZVJlc3VsdDtcbiAgICByZXR1cm4gdGhpcy5faW52b2tlKCd1cGRhdGVNZXRhZGF0YScsIHsgbWV0YWRhdGEgfSwgc2NoZW1hKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcHNlcnQgb25lIG9yIG1vcmUgY29tcG9uZW50cyBpbiB5b3VyIG9yZ2FuaXphdGlvbidzIGRhdGEuXG4gICAqL1xuICB1cHNlcnQ8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIHN0cmluZyA9IHN0cmluZyxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPih0eXBlOiBULCBtZXRhZGF0YTogTURbXSk6IFByb21pc2U8VXBzZXJ0UmVzdWx0W10+O1xuICB1cHNlcnQ8XG4gICAgTSBleHRlbmRzIE1ldGFkYXRhID0gTWV0YWRhdGEsXG4gICAgVCBleHRlbmRzIHN0cmluZyA9IHN0cmluZyxcbiAgICBNRCBleHRlbmRzIElucHV0TWV0YWRhdGFEZWZpbml0aW9uPFQsIE0+ID0gSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT5cbiAgPih0eXBlOiBULCBtZXRhZGF0YTogTUQpOiBQcm9taXNlPFVwc2VydFJlc3VsdD47XG4gIHVwc2VydDxcbiAgICBNIGV4dGVuZHMgTWV0YWRhdGEgPSBNZXRhZGF0YSxcbiAgICBUIGV4dGVuZHMgc3RyaW5nID0gc3RyaW5nLFxuICAgIE1EIGV4dGVuZHMgSW5wdXRNZXRhZGF0YURlZmluaXRpb248VCwgTT4gPSBJbnB1dE1ldGFkYXRhRGVmaW5pdGlvbjxULCBNPlxuICA+KHR5cGU6IFQsIG1ldGFkYXRhOiBNRCB8IE1EW10pOiBQcm9taXNlPFVwc2VydFJlc3VsdCB8IFVwc2VydFJlc3VsdFtdPjtcbiAgdXBzZXJ0KHR5cGU6IHN0cmluZywgbWV0YWRhdGE6IE1ldGFkYXRhIHwgTWV0YWRhdGFbXSkge1xuICAgIGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5KG1ldGFkYXRhKTtcbiAgICBtZXRhZGF0YSA9IGFzc2lnblR5cGVXaXRoTWV0YWRhdGEobWV0YWRhdGEsIHR5cGUpO1xuICAgIGNvbnN0IHNjaGVtYSA9IGlzQXJyYXlcbiAgICAgID8gW0FwaVNjaGVtYXMuVXBzZXJ0UmVzdWx0XVxuICAgICAgOiBBcGlTY2hlbWFzLlVwc2VydFJlc3VsdDtcbiAgICByZXR1cm4gdGhpcy5faW52b2tlKCd1cHNlcnRNZXRhZGF0YScsIHsgbWV0YWRhdGEgfSwgc2NoZW1hKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGVzIHNwZWNpZmllZCBtZXRhZGF0YSBjb21wb25lbnRzIGluIHRoZSBvcmdhbml6YXRpb24uXG4gICAqL1xuICBkZWxldGUodHlwZTogc3RyaW5nLCBmdWxsTmFtZXM6IHN0cmluZ1tdKTogUHJvbWlzZTxTYXZlUmVzdWx0W10+O1xuICBkZWxldGUodHlwZTogc3RyaW5nLCBmdWxsTmFtZXM6IHN0cmluZyk6IFByb21pc2U8U2F2ZVJlc3VsdD47XG4gIGRlbGV0ZShcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgZnVsbE5hbWVzOiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgKTogUHJvbWlzZTxTYXZlUmVzdWx0IHwgU2F2ZVJlc3VsdFtdPjtcbiAgZGVsZXRlKHR5cGU6IHN0cmluZywgZnVsbE5hbWVzOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICAgIGNvbnN0IHNjaGVtYSA9IEFycmF5LmlzQXJyYXkoZnVsbE5hbWVzKVxuICAgICAgPyBbQXBpU2NoZW1hcy5TYXZlUmVzdWx0XVxuICAgICAgOiBBcGlTY2hlbWFzLlNhdmVSZXN1bHQ7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZSgnZGVsZXRlTWV0YWRhdGEnLCB7IHR5cGUsIGZ1bGxOYW1lcyB9LCBzY2hlbWEpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmFtZSBmdWxsbmFtZSBvZiBhIG1ldGFkYXRhIGNvbXBvbmVudCBpbiB0aGUgb3JnYW5pemF0aW9uXG4gICAqL1xuICByZW5hbWUoXG4gICAgdHlwZTogc3RyaW5nLFxuICAgIG9sZEZ1bGxOYW1lOiBzdHJpbmcsXG4gICAgbmV3RnVsbE5hbWU6IHN0cmluZyxcbiAgKTogUHJvbWlzZTxTYXZlUmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZShcbiAgICAgICdyZW5hbWVNZXRhZGF0YScsXG4gICAgICB7IHR5cGUsIG9sZEZ1bGxOYW1lLCBuZXdGdWxsTmFtZSB9LFxuICAgICAgQXBpU2NoZW1hcy5TYXZlUmVzdWx0LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHRoZSBtZXRhZGF0YSB3aGljaCBkZXNjcmliZXMgeW91ciBvcmdhbml6YXRpb24sIGluY2x1ZGluZyBBcGV4IGNsYXNzZXMgYW5kIHRyaWdnZXJzLFxuICAgKiBjdXN0b20gb2JqZWN0cywgY3VzdG9tIGZpZWxkcyBvbiBzdGFuZGFyZCBvYmplY3RzLCB0YWIgc2V0cyB0aGF0IGRlZmluZSBhbiBhcHAsXG4gICAqIGFuZCBtYW55IG90aGVyIGNvbXBvbmVudHMuXG4gICAqL1xuICBkZXNjcmliZShhc09mVmVyc2lvbj86IHN0cmluZyk6IFByb21pc2U8RGVzY3JpYmVNZXRhZGF0YVJlc3VsdD4ge1xuICAgIGlmICghYXNPZlZlcnNpb24pIHtcbiAgICAgIGFzT2ZWZXJzaW9uID0gdGhpcy5fY29ubi52ZXJzaW9uO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5faW52b2tlKFxuICAgICAgJ2Rlc2NyaWJlTWV0YWRhdGEnLFxuICAgICAgeyBhc09mVmVyc2lvbiB9LFxuICAgICAgQXBpU2NoZW1hcy5EZXNjcmliZU1ldGFkYXRhUmVzdWx0LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHByb3BlcnR5IGluZm9ybWF0aW9uIGFib3V0IG1ldGFkYXRhIGNvbXBvbmVudHMgaW4geW91ciBvcmdhbml6YXRpb25cbiAgICovXG4gIGxpc3QoXG4gICAgcXVlcmllczogTGlzdE1ldGFkYXRhUXVlcnkgfCBMaXN0TWV0YWRhdGFRdWVyeVtdLFxuICAgIGFzT2ZWZXJzaW9uPzogc3RyaW5nLFxuICApOiBQcm9taXNlPEZpbGVQcm9wZXJ0aWVzW10+IHtcbiAgICBpZiAoIWFzT2ZWZXJzaW9uKSB7XG4gICAgICBhc09mVmVyc2lvbiA9IHRoaXMuX2Nvbm4udmVyc2lvbjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZSgnbGlzdE1ldGFkYXRhJywgeyBxdWVyaWVzLCBhc09mVmVyc2lvbiB9LCBbXG4gICAgICBBcGlTY2hlbWFzLkZpbGVQcm9wZXJ0aWVzLFxuICAgIF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyB0aGUgc3RhdHVzIG9mIGFzeW5jaHJvbm91cyBtZXRhZGF0YSBjYWxsc1xuICAgKi9cbiAgY2hlY2tTdGF0dXMoYXN5bmNQcm9jZXNzSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHJlcyA9IHRoaXMuX2ludm9rZShcbiAgICAgICdjaGVja1N0YXR1cycsXG4gICAgICB7IGFzeW5jUHJvY2Vzc0lkIH0sXG4gICAgICBBcGlTY2hlbWFzLkFzeW5jUmVzdWx0LFxuICAgICk7XG4gICAgcmV0dXJuIG5ldyBBc3luY1Jlc3VsdExvY2F0b3IodGhpcywgcmVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgWE1MIGZpbGUgcmVwcmVzZW50YXRpb25zIG9mIGNvbXBvbmVudHMgaW4gYW4gb3JnYW5pemF0aW9uXG4gICAqL1xuICByZXRyaWV2ZShyZXF1ZXN0OiBQYXJ0aWFsPFJldHJpZXZlUmVxdWVzdD4pIHtcbiAgICBjb25zdCByZXMgPSB0aGlzLl9pbnZva2UoXG4gICAgICAncmV0cmlldmUnLFxuICAgICAgeyByZXF1ZXN0IH0sXG4gICAgICBBcGlTY2hlbWFzLlJldHJpZXZlUmVzdWx0LFxuICAgICk7XG4gICAgcmV0dXJuIG5ldyBSZXRyaWV2ZVJlc3VsdExvY2F0b3IodGhpcywgcmVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgdGhlIHN0YXR1cyBvZiBkZWNsYXJhdGl2ZSBtZXRhZGF0YSBjYWxsIHJldHJpZXZlKCkgYW5kIHJldHVybnMgdGhlIHppcCBmaWxlIGNvbnRlbnRzXG4gICAqL1xuICBjaGVja1JldHJpZXZlU3RhdHVzKGFzeW5jUHJvY2Vzc0lkOiBzdHJpbmcpOiBQcm9taXNlPFJldHJpZXZlUmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZShcbiAgICAgICdjaGVja1JldHJpZXZlU3RhdHVzJyxcbiAgICAgIHsgYXN5bmNQcm9jZXNzSWQgfSxcbiAgICAgIEFwaVNjaGVtYXMuUmV0cmlldmVSZXN1bHQsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaWxsIGRlcGxveSBhIHJlY2VudGx5IHZhbGlkYXRlZCBkZXBsb3kgcmVxdWVzdFxuICAgKlxuICAgKiBAcGFyYW0gb3B0aW9ucy5pZCA9IHRoZSBkZXBsb3kgSUQgdGhhdCdzIGJlZW4gdmFsaWRhdGVkIGFscmVhZHkgZnJvbSBhIHByZXZpb3VzIGNoZWNrT25seSBkZXBsb3kgcmVxdWVzdFxuICAgKiBAcGFyYW0gb3B0aW9ucy5yZXN0ID0gYSBib29sZWFuIHdoZXRoZXIgb3Igbm90IHRvIHVzZSB0aGUgUkVTVCBBUElcbiAgICogQHJldHVybnMgdGhlIGRlcGxveSBJRCBvZiB0aGUgcmVjZW50IHZhbGlkYXRpb24gcmVxdWVzdFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlcGxveVJlY2VudFZhbGlkYXRpb24ob3B0aW9uczoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgcmVzdD86IGJvb2xlYW47XG4gIH0pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHsgaWQsIHJlc3QgfSA9IG9wdGlvbnM7XG4gICAgbGV0IHJlc3BvbnNlOiBzdHJpbmc7XG4gICAgaWYgKHJlc3QpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2VCb2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB2YWxpZGF0ZWREZXBsb3lSZXF1ZXN0SWQ6IGlkLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3RJbmZvOiBIdHRwUmVxdWVzdCA9IHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIHVybDogYCR7dGhpcy5fY29ubi5fYmFzZVVybCgpfS9tZXRhZGF0YS9kZXBsb3lSZXF1ZXN0YCxcbiAgICAgICAgYm9keTogbWVzc2FnZUJvZHksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHJlcXVlc3RPcHRpb25zID0geyBoZWFkZXJzOiAnanNvbicgfTtcbiAgICAgIC8vIFRoaXMgaXMgdGhlIGRlcGxveSBJRCBvZiB0aGUgZGVwbG95UmVjZW50VmFsaWRhdGlvbiByZXNwb25zZSwgbm90XG4gICAgICAvLyB0aGUgYWxyZWFkeSB2YWxpZGF0ZWQgZGVwbG95IElEIChpLmUuLCB2YWxpZGF0ZWRkZXBsb3lyZXF1ZXN0aWQpLlxuICAgICAgLy8gUkVTVCByZXR1cm5zIGFuIG9iamVjdCB3aXRoIGFuIGlkIHByb3BlcnR5LCBTT0FQIHJldHVybnMgdGhlIGlkIGFzIGEgc3RyaW5nIGRpcmVjdGx5LlxuICAgICAgcmVzcG9uc2UgPSAoXG4gICAgICAgIGF3YWl0IHRoaXMuX2Nvbm4ucmVxdWVzdDx7IGlkOiBzdHJpbmcgfT4ocmVxdWVzdEluZm8sIHJlcXVlc3RPcHRpb25zKVxuICAgICAgKS5pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLl9pbnZva2UoJ2RlcGxveVJlY2VudFZhbGlkYXRpb24nLCB7XG4gICAgICAgIHZhbGlkYXRpb25JZDogaWQsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICAvKipcbiAgICogRGVwbG95IGNvbXBvbmVudHMgaW50byBhbiBvcmdhbml6YXRpb24gdXNpbmcgemlwcGVkIGZpbGUgcmVwcmVzZW50YXRpb25zXG4gICAqIHVzaW5nIHRoZSBSRVNUIE1ldGFkYXRhIEFQSSBpbnN0ZWFkIG9mIFNPQVBcbiAgICovXG4gIGRlcGxveVJlc3QoXG4gICAgemlwSW5wdXQ6IEJ1ZmZlcixcbiAgICBvcHRpb25zOiBQYXJ0aWFsPERlcGxveU9wdGlvbnM+ID0ge30sXG4gICk6IERlcGxveVJlc3VsdExvY2F0b3I8Uz4ge1xuICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcbiAgICBmb3JtLmFwcGVuZCgnZmlsZScsIHppcElucHV0LCB7XG4gICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3ppcCcsXG4gICAgICBmaWxlbmFtZTogJ3BhY2thZ2UueG1sJyxcbiAgICB9KTtcblxuICAgIC8vIEFkZCB0aGUgZGVwbG95IG9wdGlvbnNcbiAgICBmb3JtLmFwcGVuZCgnZW50aXR5X2NvbnRlbnQnLCBKU09OLnN0cmluZ2lmeSh7IGRlcGxveU9wdGlvbnM6IG9wdGlvbnMgfSksIHtcbiAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXF1ZXN0OiBIdHRwUmVxdWVzdCA9IHtcbiAgICAgIHVybDogJy9tZXRhZGF0YS9kZXBsb3lSZXF1ZXN0JyxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogeyAuLi5mb3JtLmdldEhlYWRlcnMoKSB9LFxuICAgICAgYm9keTogZm9ybS5nZXRCdWZmZXIoKSxcbiAgICB9O1xuICAgIGNvbnN0IHJlcyA9IHRoaXMuX2Nvbm4ucmVxdWVzdDxBc3luY1Jlc3VsdD4ocmVxdWVzdCk7XG5cbiAgICByZXR1cm4gbmV3IERlcGxveVJlc3VsdExvY2F0b3IodGhpcywgcmVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXBsb3kgY29tcG9uZW50cyBpbnRvIGFuIG9yZ2FuaXphdGlvbiB1c2luZyB6aXBwZWQgZmlsZSByZXByZXNlbnRhdGlvbnNcbiAgICovXG4gIGRlcGxveShcbiAgICB6aXBJbnB1dDogUmVhZGFibGUgfCBCdWZmZXIgfCBzdHJpbmcsXG4gICAgb3B0aW9uczogUGFydGlhbDxEZXBsb3lPcHRpb25zPiA9IHt9LFxuICApOiBEZXBsb3lSZXN1bHRMb2NhdG9yPFM+IHtcbiAgICBjb25zdCByZXMgPSAoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgemlwQ29udGVudEI2NCA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGlzT2JqZWN0KHppcElucHV0KSAmJlxuICAgICAgICAgICdwaXBlJyBpbiB6aXBJbnB1dCAmJlxuICAgICAgICAgIHR5cGVvZiB6aXBJbnB1dC5waXBlID09PSAnZnVuY3Rpb24nXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnN0IGJ1ZnM6IEJ1ZmZlcltdID0gW107XG4gICAgICAgICAgemlwSW5wdXQub24oJ2RhdGEnLCAoZCkgPT4gYnVmcy5wdXNoKGQpKTtcbiAgICAgICAgICB6aXBJbnB1dC5vbignZXJyb3InLCByZWplY3QpO1xuICAgICAgICAgIHppcElucHV0Lm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKEJ1ZmZlci5jb25jYXQoYnVmcykudG9TdHJpbmcoJ2Jhc2U2NCcpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyB6aXBJbnB1dC5yZXN1bWUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh6aXBJbnB1dCBpbnN0YW5jZW9mIEJ1ZmZlcikge1xuICAgICAgICAgIHJlc29sdmUoemlwSW5wdXQudG9TdHJpbmcoJ2Jhc2U2NCcpKTtcbiAgICAgICAgfSBlbHNlIGlmICh6aXBJbnB1dCBpbnN0YW5jZW9mIFN0cmluZyB8fCB0eXBlb2YgemlwSW5wdXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmVzb2x2ZSh6aXBJbnB1dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgJ1VuZXhwZWN0ZWQgemlwSW5wdXQgdHlwZSc7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5faW52b2tlKFxuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAge1xuICAgICAgICAgIFppcEZpbGU6IHppcENvbnRlbnRCNjQsXG4gICAgICAgICAgRGVwbG95T3B0aW9uczogb3B0aW9ucyxcbiAgICAgICAgfSxcbiAgICAgICAgQXBpU2NoZW1hcy5EZXBsb3lSZXN1bHQsXG4gICAgICApO1xuICAgIH0pKCk7XG5cbiAgICByZXR1cm4gbmV3IERlcGxveVJlc3VsdExvY2F0b3IodGhpcywgcmVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgdGhlIHN0YXR1cyBvZiBkZWNsYXJhdGl2ZSBtZXRhZGF0YSBjYWxsIGRlcGxveSgpLCB1c2luZyBlaXRoZXJcbiAgICogU09BUCBvciBSRVNUIEFQSXMuIFNPQVAgaXMgdGhlIGRlZmF1bHQuXG4gICAqL1xuICBhc3luYyBjaGVja0RlcGxveVN0YXR1cyhcbiAgICBhc3luY1Byb2Nlc3NJZDogc3RyaW5nLFxuICAgIGluY2x1ZGVEZXRhaWxzOiBib29sZWFuID0gZmFsc2UsXG4gICAgcmVzdDogYm9vbGVhbiA9IGZhbHNlLFxuICApOiBQcm9taXNlPERlcGxveVJlc3VsdD4ge1xuICAgIGlmIChyZXN0KSB7XG4gICAgICBjb25zdCB1cmwgPSBgL21ldGFkYXRhL2RlcGxveVJlcXVlc3QvJHthc3luY1Byb2Nlc3NJZH0ke2luY2x1ZGVEZXRhaWxzID8gJz9pbmNsdWRlRGV0YWlscz10cnVlJyA6ICcnfWA7XG4gICAgICB0eXBlIENoZWNrRGVwbG95U3RhdHVzUmVzdCA9IHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgdmFsaWRhdGVkRGVwbG95UmVxdWVzdElkOiBzdHJpbmcgfCBudWxsO1xuICAgICAgICBkZXBsb3lSZXN1bHQ6IERlcGxveVJlc3VsdDtcbiAgICAgICAgZGVwbG95T3B0aW9uczogRGVwbG95T3B0aW9ucyB8IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gKGF3YWl0IHRoaXMuX2Nvbm4ucmVxdWVzdEdldDxDaGVja0RlcGxveVN0YXR1c1Jlc3Q+KHVybCkpLmRlcGxveVJlc3VsdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShcbiAgICAgICAgJ2NoZWNrRGVwbG95U3RhdHVzJyxcbiAgICAgICAge1xuICAgICAgICAgIGFzeW5jUHJvY2Vzc0lkLFxuICAgICAgICAgIGluY2x1ZGVEZXRhaWxzLFxuICAgICAgICB9LFxuICAgICAgICBBcGlTY2hlbWFzLkRlcGxveVJlc3VsdCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY2FuY2VsRGVwbG95KGlkOiBzdHJpbmcpOiBQcm9taXNlPENhbmNlbERlcGxveVJlc3VsdD57XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZSgnY2FuY2VsRGVwbG95JywgeyBpZCB9KVxuICB9XG59XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4vKipcbiAqIFRoZSBsb2NhdG9yIGNsYXNzIGZvciBNZXRhZGF0YSBBUEkgYXN5bmNocm9ub3VzIGNhbGwgcmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBBc3luY1Jlc3VsdExvY2F0b3I8XG4gIFMgZXh0ZW5kcyBTY2hlbWEsXG4gIFIgZXh0ZW5kcyB7fSA9IEFzeW5jUmVzdWx0XG4+IGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgX21ldGE6IE1ldGFkYXRhQXBpPFM+O1xuICBfcHJvbWlzZTogUHJvbWlzZTxBc3luY1Jlc3VsdD47XG4gIF9pZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKlxuICAgKi9cbiAgY29uc3RydWN0b3IobWV0YTogTWV0YWRhdGFBcGk8Uz4sIHByb21pc2U6IFByb21pc2U8QXN5bmNSZXN1bHQ+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9tZXRhID0gbWV0YTtcbiAgICB0aGlzLl9wcm9taXNlID0gcHJvbWlzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9taXNlL0ErIGludGVyZmFjZVxuICAgKiBodHRwOi8vcHJvbWlzZXMtYXBsdXMuZ2l0aHViLmlvL3Byb21pc2VzLXNwZWMvXG4gICAqXG4gICAqIEBtZXRob2QgTWV0YWRhdGF+QXN5bmNSZXN1bHRMb2NhdG9yI3RoZW5cbiAgICovXG4gIHRoZW48VSwgVj4oXG4gICAgb25SZXNvbHZlPzogKChyZXN1bHQ6IEFzeW5jUmVzdWx0KSA9PiBVIHwgUHJvbWlzZTxVPikgfCBudWxsIHwgdW5kZWZpbmVkLFxuICAgIG9uUmVqZWN0PzogKChlcnI6IEVycm9yKSA9PiBWIHwgUHJvbWlzZTxWPikgfCBudWxsIHwgdW5kZWZpbmVkLFxuICApOiBQcm9taXNlPFUgfCBWPiB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb21pc2UudGhlbihvblJlc29sdmUsIG9uUmVqZWN0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayB0aGUgc3RhdHVzIG9mIGFzeW5jIHJlcXVlc3RcbiAgICovXG4gIGFzeW5jIGNoZWNrKCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX3Byb21pc2U7XG4gICAgdGhpcy5faWQgPSByZXN1bHQuaWQ7XG4gICAgcmV0dXJuIHRoaXMuX21ldGEuY2hlY2tTdGF0dXMocmVzdWx0LmlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQb2xsaW5nIHVudGlsIGFzeW5jIGNhbGwgc3RhdHVzIGJlY29tZXMgY29tcGxldGUgb3IgZXJyb3JcbiAgICovXG4gIHBvbGwoaW50ZXJ2YWw6IG51bWJlciwgdGltZW91dDogbnVtYmVyKSB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgcG9sbCA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICBpZiAoc3RhcnRUaW1lICsgdGltZW91dCA8IG5vdykge1xuICAgICAgICAgIGxldCBlcnJNc2cgPSAnUG9sbGluZyB0aW1lIG91dC4nO1xuICAgICAgICAgIGlmICh0aGlzLl9pZCkge1xuICAgICAgICAgICAgZXJyTXNnICs9ICcgUHJvY2VzcyBJZCA9ICcgKyB0aGlzLl9pZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcihlcnJNc2cpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jaGVjaygpO1xuICAgICAgICBpZiAocmVzdWx0LmRvbmUpIHtcbiAgICAgICAgICB0aGlzLmVtaXQoJ2NvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzdWx0KTtcbiAgICAgICAgICBzZXRUaW1lb3V0KHBvbGwsIGludGVydmFsKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgfVxuICAgIH07XG4gICAgc2V0VGltZW91dChwb2xsLCBpbnRlcnZhbCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgYW5kIHdhaXQgdW50aWwgdGhlIGFzeW5jIHJlcXVlc3RzIGJlY29tZSBpbiBjb21wbGV0ZWQgc3RhdHVzXG4gICAqL1xuICBjb21wbGV0ZSgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8Uj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy5vbignY29tcGxldGUnLCByZXNvbHZlKTtcbiAgICAgIHRoaXMub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICAgIHRoaXMucG9sbCh0aGlzLl9tZXRhLnBvbGxJbnRlcnZhbCwgdGhpcy5fbWV0YS5wb2xsVGltZW91dCk7XG4gICAgfSk7XG4gIH1cbn1cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vKipcbiAqIFRoZSBsb2NhdG9yIGNsYXNzIHRvIHRyYWNrIHJldHJlaXZlKCkgTWV0YWRhdGEgQVBJIGNhbGwgcmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBSZXRyaWV2ZVJlc3VsdExvY2F0b3I8UyBleHRlbmRzIFNjaGVtYT4gZXh0ZW5kcyBBc3luY1Jlc3VsdExvY2F0b3I8XG4gIFMsXG4gIFJldHJpZXZlUmVzdWx0XG4+IHtcbiAgLyoqXG4gICAqIFBvbGwgY2hlY2tSZXRyaWV2ZVN0YXR1cygpIHVudGlsIHRoZSByZXRyaWV2ZSBvcGVyYXRpb24gY29tcGxldGVzLFxuICAgKiB0aGVuIHJldHVybiB0aGUgUmV0cmlldmVSZXN1bHQuXG4gICAqL1xuICBhc3luYyBjb21wbGV0ZSgpIHtcbiAgICBpZiAoIXRoaXMuX2lkKSB7XG4gICAgICBjb25zdCBhc3luY1Jlc3VsdCA9IGF3YWl0IHRoaXMuX3Byb21pc2U7XG4gICAgICB0aGlzLl9pZCA9IGFzeW5jUmVzdWx0LmlkO1xuICAgIH1cbiAgICBjb25zdCBpZCA9IHRoaXMuX2lkO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFJldHJpZXZlUmVzdWx0PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgY29uc3QgcG9sbCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgICBpZiAoc3RhcnRUaW1lICsgdGhpcy5fbWV0YS5wb2xsVGltZW91dCA8IG5vdykge1xuICAgICAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKCdQb2xsaW5nIHRpbWUgb3V0LiBSZXRyaWV2ZSBvcGVyYXRpb24gaXMgbm90IGNvbXBsZXRlZC4nKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX21ldGEuY2hlY2tSZXRyaWV2ZVN0YXR1cyhpZCk7XG4gICAgICAgICAgaWYgKHJlc3VsdC5kb25lKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2NvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3VsdCk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHBvbGwsIHRoaXMuX21ldGEucG9sbEludGVydmFsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBzZXRUaW1lb3V0KHBvbGwsIHRoaXMuX21ldGEucG9sbEludGVydmFsKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFuZ2UgdGhlIHJldHJpZXZlZCByZXN1bHQgdG8gTm9kZS5qcyByZWFkYWJsZSBzdHJlYW1cbiAgICovXG4gIHN0cmVhbSgpIHtcbiAgICBjb25zdCByZXN1bHRTdHJlYW0gPSBuZXcgUmVhZGFibGUoKTtcbiAgICBsZXQgcmVhZGluZyA9IGZhbHNlO1xuICAgIHJlc3VsdFN0cmVhbS5fcmVhZCA9IGFzeW5jICgpID0+IHtcbiAgICAgIGlmIChyZWFkaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHJlYWRpbmcgPSB0cnVlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jb21wbGV0ZSgpO1xuICAgICAgICByZXN1bHRTdHJlYW0ucHVzaChCdWZmZXIuZnJvbShyZXN1bHQuemlwRmlsZSwgJ2Jhc2U2NCcpKTtcbiAgICAgICAgcmVzdWx0U3RyZWFtLnB1c2gobnVsbCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlc3VsdFN0cmVhbS5lbWl0KCdlcnJvcicsIGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHJlc3VsdFN0cmVhbTtcbiAgfVxufVxuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbi8qKlxuICogVGhlIGxvY2F0b3IgY2xhc3MgdG8gdHJhY2sgZGVwbG95KCkgTWV0YWRhdGEgQVBJIGNhbGwgcmVzdWx0XG4gKlxuICogQHByb3RlY3RlZFxuICogQGNsYXNzIE1ldGFkYXRhfkRlcGxveVJlc3VsdExvY2F0b3JcbiAqIEBleHRlbmRzIE1ldGFkYXRhfkFzeW5jUmVzdWx0TG9jYXRvclxuICogQHBhcmFtIHtNZXRhZGF0YX0gbWV0YSAtIE1ldGFkYXRhIEFQSSBvYmplY3RcbiAqIEBwYXJhbSB7UHJvbWlzZS48TWV0YWRhdGF+QXN5bmNSZXN1bHQ+fSByZXN1bHQgLSBQcm9taXNlIG9iamVjdCBmb3IgYXN5bmMgcmVzdWx0IG9mIGRlcGxveSgpIGNhbGxcbiAqL1xuZXhwb3J0IGNsYXNzIERlcGxveVJlc3VsdExvY2F0b3I8UyBleHRlbmRzIFNjaGVtYT4gZXh0ZW5kcyBBc3luY1Jlc3VsdExvY2F0b3I8XG4gIFMsXG4gIERlcGxveVJlc3VsdFxuPiB7XG4gIC8qKlxuICAgKiBQb2xsIGNoZWNrRGVwbG95U3RhdHVzKCkgdW50aWwgdGhlIGRlcGxveSBvcGVyYXRpb24gY29tcGxldGVzLFxuICAgKiB0aGVuIHJldHVybiB0aGUgRGVwbG95UmVzdWx0LlxuICAgKi9cbiAgYXN5bmMgY29tcGxldGUoaW5jbHVkZURldGFpbHM/OiBib29sZWFuKSB7XG4gICAgaWYgKCF0aGlzLl9pZCkge1xuICAgICAgY29uc3QgYXN5bmNSZXN1bHQgPSBhd2FpdCB0aGlzLl9wcm9taXNlO1xuICAgICAgdGhpcy5faWQgPSBhc3luY1Jlc3VsdC5pZDtcbiAgICB9XG4gICAgY29uc3QgaWQgPSB0aGlzLl9pZDtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZTxEZXBsb3lSZXN1bHQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICBjb25zdCBwb2xsID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgIGlmIChzdGFydFRpbWUgKyB0aGlzLl9tZXRhLnBvbGxUaW1lb3V0IDwgbm93KSB7XG4gICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoJ1BvbGxpbmcgdGltZSBvdXQuIERlcGxveSBvcGVyYXRpb24gaXMgbm90IGNvbXBsZXRlZC4nKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX21ldGEuY2hlY2tEZXBsb3lTdGF0dXMoaWQsIGluY2x1ZGVEZXRhaWxzKTtcbiAgICAgICAgICBpZiAocmVzdWx0LmRvbmUpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnY29tcGxldGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzdWx0KTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQocG9sbCwgdGhpcy5fbWV0YS5wb2xsSW50ZXJ2YWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNldFRpbWVvdXQocG9sbCwgdGhpcy5fbWV0YS5wb2xsSW50ZXJ2YWwpO1xuICAgIH0pO1xuICB9XG59XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuLypcbiAqIFJlZ2lzdGVyIGhvb2sgaW4gY29ubmVjdGlvbiBpbnN0YW50aWF0aW9uIGZvciBkeW5hbWljYWxseSBhZGRpbmcgdGhpcyBBUEkgbW9kdWxlIGZlYXR1cmVzXG4gKi9cbnJlZ2lzdGVyTW9kdWxlKCdtZXRhZGF0YScsIChjb25uKSA9PiBuZXcgTWV0YWRhdGFBcGkoY29ubikpO1xuXG5leHBvcnQgZGVmYXVsdCBNZXRhZGF0YUFwaTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBU0EsWUFBWSxRQUFRLFFBQVE7QUFDckMsU0FBU0MsUUFBUSxRQUFRLFFBQVE7QUFDakMsT0FBT0MsUUFBUSxNQUFNLFdBQVc7QUFDaEMsU0FBU0MsY0FBYyxRQUFRLFlBQVk7QUFFM0MsT0FBT0MsSUFBSSxNQUFNLFNBQVM7QUFDMUIsU0FBU0MsUUFBUSxRQUFRLGtCQUFrQjtBQUUzQyxTQUNFQyxVQUFVLFFBY0wsbUJBQW1CO0FBQzFCLGNBQWMsbUJBQW1COztBQUVqQztBQUNBO0FBQ0E7O0FBaUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVNDLDBCQUEwQkEsQ0FB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